
// Copyright (c) CLMS. All rights reserved.
// Licensed under the AGPL-3.0 license. See LICENSE file in the project root for full license information.
// This source file was autogenerated by zAppDev(r).

using System;
using System.Runtime.Serialization;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Reflection;
using System.Collections;
using zAppDev.DotNet.Framework.Utilities;
using zAppDev.DotNet.Framework.Configuration;
using zAppDev.DotNet.Framework.Data.Domain;

using DSS2_SynchromodalityCapacityOptimisation.DAL;

namespace DSS2_SynchromodalityCapacityOptimisation.BO
{
	/// <summary>
	/// The SalesForecastDetails extensions
	/// </summary>
	public static class SalesForecastDetailsExtensions
	{
        public static void ComputeAllAvgDailyDemandForecastPerSKUPerWareHouse(){using (new zAppDev.DotNet.Framework.Profiling.Profiler("SalesForecastDetails", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "ComputeAllAvgDailyDemandForecastPerSKUPerWareHouse")) {
foreach (var warehouse in new DSS2_SynchromodalityCapacityOptimisation.DAL.Repository().GetAll<DSS2_SynchromodalityCapacityOptimisation.BO.Warehouse>() ?? Enumerable.Empty<DSS2_SynchromodalityCapacityOptimisation.BO.Warehouse>()) {
foreach (var item in new DSS2_SynchromodalityCapacityOptimisation.DAL.Repository().GetAll<DSS2_SynchromodalityCapacityOptimisation.BO.Item>() ?? Enumerable.Empty<DSS2_SynchromodalityCapacityOptimisation.BO.Item>()) {
System.Collections.Generic.List<DSS2_SynchromodalityCapacityOptimisation.BO.SalesForecastDetails> salesfor = new DSS2_SynchromodalityCapacityOptimisation.DAL.Repository().Get<DSS2_SynchromodalityCapacityOptimisation.BO.SalesForecastDetails>((a) => a.Item.SKU == item.SKU && a.Warehouse.Id == warehouse.Id);
if ((salesfor?.Count() == 0)) {
continue;}
decimal? avgDemand = (salesfor?.Sum((a) => a.Units) ?? 0) / (salesfor?.Count() ?? 0);
foreach (var saleforecast in salesfor ?? Enumerable.Empty<DSS2_SynchromodalityCapacityOptimisation.BO.SalesForecastDetails>()) {
saleforecast.AvgDailyDemandForecast = avgDemand;new DSS2_SynchromodalityCapacityOptimisation.DAL.Repository().Save<DSS2_SynchromodalityCapacityOptimisation.BO.SalesForecastDetails>(saleforecast);
}
}
}
}
}



        
	}
}
